# Machine-independent configuration

alias rm='rm -i'
alias cp='cp -i'
alias mv='mv -i'
alias ..='cd ..'
alias l='ls -F'
alias la='ls -FA'
alias ll='ls -Fl'
alias gg='git grep'
alias gd='git diff -w --color-words'
#alias tmux='TERM=screen-256color-bce tmux -2'

# http://stackoverflow.com/questions/4332478/read-the-current-text-color-in-a-xterm/4332530#4332530
BLACK=$(tput setaf 0)
RED=$(tput setaf 1)
GREEN=$(tput setaf 2)
YELLOW=$(tput setaf 3)
BLUE=$(tput setaf 4)
MAGENTA=$(tput setaf 5)
CYAN=$(tput setaf 6)
WHITE=$(tput setaf 7)
BRIGHT=$(tput bold)
NORMAL=$(tput sgr0)
BLINK=$(tput blink)
REVERSE=$(tput smso)
UNDERLINE=$(tput smul)
# echo "${RED}this is red ${NORMAL}this is normal"

# Make it so that the prompt knows when we're in a git repo
source ~/.dotfiles/.git-prompt.sh
export GIT_PS1_SHOWDIRTYSTATE=true
export GIT_PS1_SHOWSTASHSTATE=true
export GIT_PS1_SHOWUNTRACKEDFILES=true
export GIT_PS1_STATESEPARATOR=''

# If we're root, change our PS1
if [[ $EUID -ne 0 ]]; then
    USERCOLOR=${WHITE}
    USERSYMBOL='⌁'
else
    USERCOLOR=${RED}
    USERSYMBOL='⚠'
fi

# Fix long lines gobbling the prompt with \[ and \]
#PS1='\n${BRIGHT}${MAGENTA}\h:\w${NORMAL}$(__git_ps1 " [%s]")\n\[${USERCOLOR}\]${USERSYMBOL}\[${NORMAL}\] '

function prompt_right() {
    echo -e '${BRIGHT}${BLACK}\\t${NORMAL}'
}

function prompt_left() {
    echo -e '${MAGENTA}\h${NORMAL}:${BRIGHT}${MAGENTA}\w${NORMAL}$(__git_ps1 "@${BRIGHT}${BLUE}%s")'
}

function prompt_newline() {
    echo -e '\[${USERCOLOR}\]${USERSYMBOL}\[${NORMAL}\] '
}

function prompt() {
    compensate=20
    PS1=$(printf "\n%*s\r%s\n%s" "$(($(tput cols)+${compensate}))" "$(prompt_right)" "$(prompt_left)" "$(prompt_newline)")
}

PROMPT_COMMAND=prompt

# Default editor
export VISUAL='/usr/bin/vim'

shopt -s checkjobs  # Don't let us exit the session if there are stopped jobs
shopt -s extglob  # Turn on extended pattern matching via globs
shopt -s globstar  # Refer to files deep in a directory with **/foo

# Prevent ^S from doing its thing
stty stop undef

# Improvements to history
export HISTSIZE=100000000
export HISTCONTROL='ignoreboth:erasedups'
